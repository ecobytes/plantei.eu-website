{{> header}}
{{> menu}}
<div class="pageWrap background-primary">
	<div class="container">
		<div class="row lmt">
			{{> formErrors}}
			<div class="col-md-12 text-center">
				<h1>{{#if update}}Actualizar{{else}}Registar um nova{{/if}} semente</h1>
			</div> 
			<div id="seed-preview" class="col-md-8 col-md-offset-2" style="border: 5px solid red; background-color: #9ACD32; background-color: rgba(154,205,50,0.5); display:none;" ></div>
      <form class="form-horizontal" role="form" method="POST" action="/seedbank/register">
        <input type="hidden" name="_token" value="{{ csrfToken }}">
        <input type="hidden" name="_id" value="{{ oldInput.id }}">
        <input type="hidden" name="seed_id" value="{{ oldInput.seed_id }}">
        <div class="col-md-12">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="color: black;">
            <div class="panel panel-default"><!-- Accordion Identification -->
              <div class="panel-heading" role="tab" id="headingIdentification">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#identification" aria-expanded="true" aria-controls="collapseIdentification">
                    Identificação
                  </a>
                </h4>
              </div>
              <div id="identification" class="panel-collapse collapse in" data-parent="#accordion" role="tabpanel" aria-labelledby="headingIdentification">
                <div class="panel-body">
                  {{#with oldInput }}
                  <div class="form-group">
                    <label class="control-label">{{../messages.common_name}}*</label>
                    <span class="cell">
                      <input type="text" class="form-control" aria-describedby="helpBlock" placeholder="" name="common_name" value="{{common_name }}">
					<span class="help-block"></span>
                    </span>
                  </div>
				  <div class="row">
				  <div class="col-md-6">
                  <div class="form-group">
                    <label class="control-label">{{../messages.local}}Local da recolha</label>
                    <span class="cell"><input type="text" class="form-control" name="local" value="{{ local }}"></span>
                  </div>
                  </div>
				  <div class="col-md-3">
                  <div class="form-group">
                    <label class="control-label">Ano da recolha</label>
                    <span class="cell"><input type="text" class="form-control" name="year" value="{{ year }}"></span>
                  </div>
                  </div>
				  <div class="col-md-3">
                  <div class="form-group">
                    <label class="control-label">Público</label>
                    <span class="cell btn-group" data-toggle="buttons">
                      <label class="btn btn-default {{#if public}}active{{/if}}">
                        <input type="radio" name="public" {{#if public}}checked{{/unless}} value="1" /> Sim
                      </label>
                      <label class="btn btn-default {{#unless public}}active{{/unless}}">
                        <input type="radio" name="public" {{#unless public}}checked{{/unless}} value="2" /> Não
                      </label>
                    </span>
                  </div>
                  </div>
                  </div>
                  <div class="form-group">
                    <!-- <label class="control-label">Descrição</label> -->
                    <span class="cell">
                      <textarea style="resize:none; overflow:hidden;" class="form-control" rows="8" autocomplete="off" placeholder="Descrição" name="description">{{description}}</textarea>
                    </span>
                  </div>
                </div>
              </div>
            </div><!-- END Accordion Identification -->
            <div class="panel panel-default"><!-- Accordion Pictures -->
              <div class="panel-heading" role="tab" id="headingPictures">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#pictures" aria-expanded="true" aria-controls="collapsePictures">
                    {{messages.pictures}}CHANGME Pictures
                  </a>
                </h4>
              </div>
              <div id="pictures" class="panel-collapse collapse" data-parent="#accordion" role="tabpanel" aria-labelledby="headingPictures">
                <div class="panel-body">
                  <span class="btn btn-success fileinput-button">
                    <i class="glyphicon glyphicon-plus"></i>
                    <span>Adiciona imagens...</span>
                    <!-- The file input field used as target for the file upload widget -->
                    <input id="fileupload" type="file" name="pictures[]" multiple>
                  </span>
                  <br>
                  <br>
                  <!-- The global progress bar -->
                  <div id="progress" class="progress" style="display:none;">
                    <div class="progress-bar progress-bar-success"></div>
                  </div>
                  <!-- The container for the uploaded files -->
                  <div id="files" class="files">
				    {{#each pictures}}
					<div class="col-md-3" style="padding-bottom: 24px;">
				        <img src="{{url}}" alt="{{label}}" data-file-id="{{id}}" class="img-responsive img-rounded">
                        <button type="button" class="btn btn-danger delete" data-type="GET" data-md5sum="{{md5sum}}" data-delete-url="/seedbank/pictures/delete/{{id}}">CHANGEME - DELETE</button>
					</div>
					{{/each}}
				  </div>
                </div>
              </div>
            </div><!-- END Accordion Pictures -->
            <div class="panel panel-default"><!-- Accordion Farming -->
              <div class="panel-heading" role="tab" id="headingFarming">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#farming" aria-expanded="true" aria-controls="collapseFarming">
                    {{messages.farming}}CHANGEME Cultivo
                  </a>
                </h4>
              </div>
              <div id="farming" class="panel-collapse collapse" data-parent="#accordion" role="tabpanel" aria-labelledby="headingFarming">
                <div class="panel-body">
				  <div class="row">
				  <div class="col-md-3">
                  <div class="form-group">
                    <label class="control-label">Sementeira Directa</label>
                    <span class="cell btn-group" data-toggle="buttons">
                      <label class="btn btn-default {{#if direct.2}}active{{/if}}">
                        <input type="radio" name="direct" value="2" /> Sim
                      </label>
                      <label class="btn btn-default {{#if direct.1}}active{{/if}}">
                        <input type="radio" name="direct" value="1" /> Não
                      </label>
                    </span>
                  </div>
				  </div>
				  <div class="col-md-3">
                  <div class="form-group">
                    <label class="control-label">Polinização</label>
                    <span class="cell btn-group" data-toggle="buttons">
                      <label class="btn btn-default {{#if polinization.1}}active{{/if}}">
                        <input type="radio" name="polinization" {{#if polinization.1}}checked{{/if}} value="1" /> Aberta
                      </label>
                      <label class="btn btn-default {{#if polinization.2}}active{{/if}}">
                        <input type="radio" name="polinization" {{#if polinization.2}}checked{{/if}} value="2" /> Fechada
                      </label>
                    </span>
                  </div>
                  </div>
				  </div>
                    <label class="control-label">Meses de cultivo</label>
                  <div class="form-group">
                    <span class="cell btn-group"  data-toggle="buttons" >
                      <label class="btn btn-default {{#if months.1}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.1}}checked{{/if}} value="1" /> Jan
                      </label>
                      <label class="btn btn-default {{#if months.2}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.2}}checked{{/if}} value="2" /> Fev
                      </label>
                      <label class="btn btn-default {{#if months.3}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.3}}checked{{/if}} value="3" /> Mar
                      </label>
                      <label class="btn btn-default {{#if months.4}}active{{/if}}">
                        <input type="checkbox" name="months[]"  {{#if months.4}}checked{{/if}}value="4" /> Abr
                      </label>
                      <label class="btn btn-default {{#if months.5}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.5}}checked{{/if}} value="5" /> Mai
                      </label>
                      <label class="btn btn-default {{#if months.6}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.6}}checked{{/if}} value="6" /> Jun
                      </label>
                    </span>
                  </div>
                  <div class="form-group">
                    <span class="cell btn-group"  data-toggle="buttons">
                      <label class="btn btn-default {{#if months.7}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.7}}checked{{/if}} value="7" /> Jul
                      </label>
                      <label class="btn btn-default {{#if months.8}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.8}}checked{{/if}} value="8" /> Ago
                      </label>
                      <label class="btn btn-default {{#if months.9}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.9}}checked{{/if}} value="9" /> Set
                      </label>
                      <label class="btn btn-default {{#if months.10}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.10}}checked{{/if}} value="10" /> Out
                      </label>
                      <label class="btn btn-default {{#if months.11}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.11}}checked{{/if}} value="11" /> Nov
                      </label>
                      <label class="btn btn-default {{#if months.12}}active{{/if}}">
                        <input type="checkbox" name="months[]" {{#if months.12}}checked{{/if}} value="12" /> Dez
                      </label>
                    </span>
                  </div>
                </div>
              </div>
            </div><!-- END Accordion Farming -->
            <div class="panel panel-default"><!-- Accordion Characteristics -->
              <div class="panel-heading" role="tab" id="headingCharacteristics">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#characteristics" aria-expanded="true" aria-controls="collapseCharacteristics">
                    {{messages.taxonomy}}CHANGME_TAXONOMY
                  </a>
                </h4>
              </div>
              <div id="characteristics" class="panel-collapse collapse" data-parent="#accordion" role="tabpanel" aria-labelledby="headingCharacteristics">
                <div class="panel-body">
                  <div class="form-group">
                    <label class="control-label">{{messages.latin_name}}</label>
                    <span class="cell">
                      <input type="text" class="form-control" placeholder="" name="latin_name" value="{{ latin_name }}">
                    </span>
                  </div>
                  <div class="form-group">
                    <label class="control-label">{{messages.family}}</label>
                    <input type="hidden" name="family_id" value="{{ family.id }}">
                    <span class="cell"><input type="text" class="form-control" name="family" value="{{ family.name }}"></span>
                  </div>
                  <div class="form-group">
                    <label class="control-label">{{messages.species}}</label>
                    <input type="hidden" name="species_id" value="{{ species.id }}">
                    <span class="cell"><input type="text" class="form-control" name="species" value="{{ species.name }}"></span>
                  </div>
                  <div class="form-group">
                    <label class="control-label">{{messages.variety}}</label>
                    <input type="hidden" name="variety_id" value="{{ variety.id }}">
                    <span class="cell"><input type="text" class="form-control" name="variety" value="{{ variety.name }}"></span>
                  </div>
                </div>
              </div>
            </div><!-- END Accordion Characteristics -->
            <div class="panel panel-default"><!-- Accordion Cooking -->
              <div class="panel-heading" role="tab" id="headingCooking">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#cooking" aria-expanded="true" aria-controls="collapseCooking">
                    {{messages.cooking}}CHANGME COOKING
                  </a>
                </h4>
              </div>
              <div id="cooking" class="panel-collapse collapse" data-parent="#accordion" role="tabpanel" aria-labelledby="headingCooking">
                <div class="panel-body">
                </div>
              </div>
            </div><!-- END Accordion Cooking -->
            <div class="panel panel-default"><!-- Accordion Medicine -->
              <div class="panel-heading" role="tab" id="headingMedicine">
                <h4 class="panel-title">
                  <a style="color: black;" role="button" data-toggle="collapse" href="#medicine" aria-expanded="true" aria-controls="collapseMedicine">
                    {{messages.cooking}}CHANGME Medicine
                  </a>
                </h4>
              </div>
              <div id="medicine" class="panel-collapse collapse" data-parent="#accordion" role="tabpanel" aria-labelledby="headingMedicine">
                <div class="panel-body">
                </div>
              </div>
            </div><!-- END Accordion Medicine -->
          </div>
        </div>
        {{/with}}
        <div class="row">
          <div class="form-group lmt">
            <div class="col-md-12 text-center">
              <button type="button" class="btn btn-danger btn-lg" id="cancel_seed">
                Cancelar
              </button>
              <button type="submit" class="btn btn-primary btn-lg">
                {{#if update}}Actualizar{{ else }}Registar{{/if}}
              </button>
            </div>
          </div>
        </div>
      </form>
		</div>
	</div>
</div>
{{>scripts}}
<script>
  $('#cancel_seed').on('click', function () {
    window.open('/seedbank/myseeds', '_self');
	return false;
  });
  $('form').on('submit', function (){
    element = $('input[name="common_name"]');
    if (! element.val()) {
	  $('#identification').collapse('show');
	  element.closest('.form-group').addClass('has-error');
	  element.next('.help-block').text('This field is the only field required');
	  element.focus();
	  return false;
	  }
    
  });
</script>
{{>pictureUploader}}
{{>footer}}
